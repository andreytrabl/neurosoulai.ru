<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NeuroSoul AI</title>

  <!-- Favicons -->
  <link rel="icon" type="image/x-icon" sizes="16x16" href="favicon-16.ico">
  <link rel="icon" type="image/x-icon" sizes="32x32" href="favicon-32.ico">
  <link rel="icon" type="image/x-icon" sizes="48x48" href="favicon-48.ico">
  <link rel="shortcut icon" href="favicon-32.ico">

  <!-- Onest -->
  <link href="https://fonts.googleapis.com/css2?family=Onest:wght@100..900&display=swap" rel="stylesheet">
  <!-- Swiper (MIT) -->
  <link rel="stylesheet" href="https://unpkg.com/swiper@11/swiper-bundle.min.css"/>
  <link rel="stylesheet" href="styles/main.css" />

  <!-- Локальные правки -->
  <style>
    html{ scroll-behavior:smooth; }

    /* Убираем «подложку» у медиа в модалке */
    .modal__media .gallery-swiper{ border-radius:0; box-shadow:none; background:transparent; margin:0; }
    .gallery-swiper .swiper-slide{ background:transparent; }

    /* Две кнопки в модалке рядом — как в хедере */
    .modal__cta{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
    .modal__cta .modal-cta{ font-weight:600; }

    /* Контактная форма */
    .contact-card{ background:#fff; border-radius:18px; box-shadow:0 20px 36px rgba(0,0,0,.10); padding:20px; max-width:880px; }
    .contact-form{ display:grid; gap:14px; }
    .contact-form label{ font-weight:700; font-size:14px; }
    .contact-form input[type="text"], .contact-form input[type="email"], .contact-form input[type="file"], .contact-form textarea{
      width:100%; border:1px solid #e5e5e5; border-radius:12px; padding:12px 14px; font:16px/1.3 var(--font); color:var(--ink); background:#fff;
    }
    .contact-form textarea{ min-height:140px; resize:vertical; }
    .contact-actions{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:6px; }
    .muted-sm{ color:var(--muted); font-size:14px; }

    /* ====== REVIEWS: простая карусель (без Swiper) ====== */
    .reviews-wrap{ position:relative; }
    .rev-carousel{ position:relative; width:100%; padding:8px 0 0; }
    .rev-viewport{
      width:100%;
      display:grid; place-items:center;
      overflow:visible; background:transparent;
      touch-action: pan-y; user-select:none; cursor:grab;
    }
    .rev-carousel.is-dragging .rev-viewport{ cursor:grabbing; }
    .rev-pane{ transition:transform .18s ease; }

    /* ширина карточки и отступы — как раньше (desktop) */
    .review-card{
      width:min(960px,86vw);
      background:linear-gradient(180deg,#fff,rgba(255,255,255,.96));
      border-radius:18px;
      padding:18px 20px;
      box-shadow:0 20px 36px rgba(0,0,0,.10);
      display:grid;
      grid-template-columns:1.08fr .92fr;
      gap:18px; align-items:center;
      box-sizing:border-box;
    }
    .rev-body{ display:grid; gap:10px; }
    .rev-head{ display:flex; align-items:center; gap:10px; }
    .rev-avatar img{ width:44px; height:44px; border-radius:999px; object-fit:cover; display:block; }
    .rev-title{ font-weight:800; line-height:1.25; }
    .rev-text{ color:var(--ink); }
    .review-card a{ color:inherit; text-decoration:none; }
    .review-card a:hover{ text-decoration:underline; }

    .rev-media{
      display:block; border-radius:14px; overflow:hidden; box-shadow:0 10px 22px rgba(0,0,0,.12);
      width:min(420px,42vw); justify-self:end;
    }
    .rev-media img,.rev-media video{ display:block; width:100%; height:auto; object-fit:cover; }

    /* стрелки вынесены к краям карусели, чтобы не перекрывать текст */
    .rev-arrow{
      --size:46px;
      position:absolute; top:50%; transform:translateY(-50%);
      width:var(--size); height:var(--size);
      border-radius:999px; border:0; cursor:pointer; background:#fff; box-shadow:0 6px 18px rgba(0,0,0,.10); z-index:5;
    }
    .rev-arrow::before{
      content:""; position:absolute; inset:0; margin:auto; width:12px; height:12px;
      border-top:2px solid #333; border-right:2px solid #333; transform:rotate(45deg);
    }
    .rev-prev{ left:clamp(6px, 2vw, 18px); }
    .rev-prev::before{ transform:rotate(225deg); }
    .rev-next{ right:clamp(6px, 2vw, 18px); }

    /* чуть расширим внутренние поля, чтобы стрелки не «липли» к краю */
    .rev-carousel{ padding-inline:clamp(28px, 4vw, 40px); }

    .rev-dots{ display:flex; gap:6px; justify-content:center; margin:10px 0 0; }
    .rev-dot{ width:8px; height:8px; border-radius:999px; background:#d7d7d7; border:0; cursor:pointer; }
    .rev-dot.is-active{ background:#222; }

    /* Лайтбокс отзывов */
    .revlightbox[aria-hidden="true"]{ display:none; }
    .revlightbox{ position:fixed; inset:0; z-index:1100; display:grid; place-items:center; }
    .revlightbox__box{ position:relative; background:#fff; border-radius:16px; width:min(940px,94vw); padding:14px; box-shadow:0 18px 38px rgba(0,0,0,.18); }
    .revlightbox__close{ position:absolute; top:8px; right:8px; width:34px; height:34px; border-radius:999px; border:0; background:#f2f2f2; cursor:pointer; font-size:18px; line-height:1; }
    .revlightbox__media img,.revlightbox__media video{ display:block; width:100%; height:auto; max-height:80vh; object-fit:contain; }

    /* Блокировка прокрутки при открытом лайтбоксе — без «прыжка» вверх */
    .body-lock{
      position:fixed;
      overflow-y:scroll; /* чтобы не менялась ширина контента из-за скроллбара */
      width:100%;
    }

    /* ===== FIX: планшеты и телефоны ===== */
    @media (max-width: 1024px){
      /* карточка и медиа занимают всю ширину контейнера */
      .review-card{
        width:100%;
        grid-template-columns:1fr;
        gap:12px;
      }
      .rev-media{
        width:100%;
        justify-self:center;
      }
      /* стрелки у внутренних краев контейнера + безопасные зоны */
      .rev-carousel{ padding-inline:16px; }
      .rev-prev{ left:max(10px, env(safe-area-inset-left)); }
      .rev-next{ right:max(10px, env(safe-area-inset-right)); }
    }

    @media (max-width: 768px){
      .rev-arrow{ --size:40px; }
    }

    @media (max-width: 640px){
      .rev-carousel{ padding-inline:12px; }
      .rev-arrow{ --size:38px; }
    }

    /* ===== THANK-YOU POPUP (добавлено) ===== */
    #thanksModal[aria-hidden="true"]{ display:none; }
    #thanksModal{
      position:fixed; inset:0; z-index:1200;
      display:grid; place-items:center;
    }
    .thanks-backdrop{
      position:absolute; inset:0; background:rgba(8,10,14,.46); backdrop-filter:saturate(120%) blur(4px);
    }
    .thanks-dialog{
      position:relative; z-index:1;
      width:min(560px, 92vw);
      border-radius:20px;
      background:#fff;
      box-shadow:0 20px 44px rgba(0,0,0,.18);
      padding:clamp(18px, 3vw, 28px);
      font-family: var(--font, "Onest", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif);
      text-align:center;
      transform:translateY(6px) scale(.98);
      animation: thanksIn .22s ease forwards;
    }
    @keyframes thanksIn{
      to{ transform:translateY(0) scale(1); }
    }
    .thanks-title{
      font-weight:900;
      font-size:clamp(20px, 3.2vw, 28px);
      line-height:1.2;
      margin:0 0 8px;
      color:var(--ink, #0b0b0b);
      letter-spacing:.2px;
    }
    .thanks-text{
      font-size:clamp(16px, 2.6vw, 18px);
      color:var(--muted, #4b4b4b);
      margin:0 0 16px;
    }
    .thanks-actions{ display:flex; justify-content:center; }
    .thanks-btn{
      appearance:none; border:0; cursor:pointer;
      border-radius:14px;
      padding:12px 18px;
      font-weight:800;
      font-size:16px;
      line-height:1;
      background:var(--primary, #111);
      color:#fff;
      box-shadow:0 10px 24px rgba(0,0,0,.14);
    }
    .thanks-close{
      position:absolute; top:10px; right:10px;
      width:36px; height:36px; border-radius:999px; border:0; cursor:pointer;
      background:#f2f2f2; font-size:18px; line-height:1;
    }
    @supports (padding:max(0px)){
      .thanks-dialog{ padding:clamp(18px, 3vw, 28px) max(18px, env(safe-area-inset-right)) clamp(18px, 3vw, 28px) max(18px, env(safe-area-inset-left)); }
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="#" aria-label="NeuroSoul — на главную">
        <img src="assets/logo.webp" alt="NeuroSoul logo">
      </a>

      <input id="nav-toggle" class="nav-toggle" type="checkbox" aria-hidden="true">
      <label class="burger" for="nav-toggle" aria-label="Открыть меню" aria-controls="main-menu" aria-expanded="false">
        <span></span>
      </label>

      <nav id="main-menu" class="menu" aria-label="Главное меню">
        <a href="#about"    onclick="document.getElementById('nav-toggle').checked=false">О нас</a>
        <a href="#services" onclick="document.getElementById('nav-toggle').checked=false">Услуги</a>
        <a href="#reviews"  onclick="document.getElementById('nav-toggle').checked=false">Отзывы</a>
        <a href="#contacts" onclick="document.getElementById('nav-toggle').checked=false">Контакты</a>
        <a href="#contacts" class="order-link" onclick="document.getElementById('nav-toggle').checked=false">Заказать</a>
      </nav>

      <a class="btn header-cta" href="#contacts">Заказать</a>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <img class="blob" src="assets/img/hero-blob.svg" alt="" aria-hidden="true">
      <div class="container hero-grid">
        <div class="hero-copy">
          <p class="eyebrow">ИЗ НЕЙРОСЕТЕЙ, НО С ДУШОЙ!</p>
          <h1 class="hero-title">КЛАССНЫЕ<br>ПОДАРКИ<br>БЛИЗКИМ</h1>
          <p class="lead">Семейное хобби, которое подарило эмоции и впечатления многим нашим близким!</p>
          <div class="cta-row">
            <a class="btn btn-primary" href="#contacts">Заказать на сайте</a>
            <a class="btn btn-tg" href="https://t.me/neurosoulai?direct" target="_blank" rel="noopener">Заказать в Telegram</a>
          </div>
        </div>
        <figure class="hero-illus" aria-label="Иллюстрация">
          <img class="hero-img" src="assets/img/hero.webp" alt="Семья с подарком">
        </figure>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="section section--over-blob">
      <div class="container">
        <h2 class="section-title">ДАВАЙТЕ ЗНАКОМИТЬСЯ!</h2>

        <div class="about-grid">
          <figure class="about-media" aria-label="Пример экрана телефона">
            <img class="phone" src="assets/img/about-phone.webp" alt="Скрин нашего телефона">
          </figure>

          <div class="about-text">
            <p>Сначала мы полюбили друг друга, потом полюбили нейросети, а сейчас любим делать уникальные подарки!</p>
            <p>В этому году мы завели канал «Оля 💛 Андрей | Семейный блог», где показали пару AI-подарков родным и близким — и к нам пришли знакомые знакомых с просьбами сделать «также круто!»</p>
            <p>Кстати, этот сайт мы тоже сделали с помощью искусственного интеллекта 😉</p>
          </div>
        </div>
      </div>
    </section>

    <!-- SERVICES (без изменений) -->
    <section id="services" class="section">
      <div class="container">
        <h2 class="section-title">ЧТО МЫ УМЕЕМ? ПОКАЗЫВАЕМ</h2>

        <div class="services-wrap" id="srvWrap">
          <button class="srv-arrow srv-prev" aria-label="Предыдущая услуга"></button>

          <div class="swiper services-swiper" aria-roledescription="carousel">
            <div class="swiper-wrapper">
              <!-- ... карточки услуг ... -->
              <div class="swiper-slide">
                <article class="service-card"
                  data-title="Реставрация фото"
                  data-price="от 500 ₽ за 1 фото"
                  data-deadline="Сроки: 1–2 дня"
                  data-desc="Восстановление любых старых фотографий: порванных, чёрно-белых, испачканных, выцветших, низкого качества 🎨&#10;&#10;— Уберём недостатки&#10;— Раскрасим&#10;— Повысим качество&#10;— Пришлём формат для печати&#10;&#10;Делаем руками в Photoshop и дожимаем через нейросети 🤖"
                  data-gallery='["assets/img/services/srv-restoration.webp"]'>
                  <h3 class="srv-name">РЕСТАВРАЦИЯ ФОТО</h3>
                  <img class="srv-img" src="assets/img/services/srv-restoration.webp" alt="Реставрация фото — пример">
                  <a class="btn more-btn" href="restoration.html">ПОДРОБНЕЕ</a>
                </article>
              </div>

              <div class="swiper-slide">
                <article class="service-card"
                  data-title="Оживление фото"
                  data-price="от 500 ₽ за 1 фото"
                  data-deadline="Сроки: 1–2 дня"
                  data-desc="Оживим любое ваше фото: старое или новое, чёрно-белое или цветное, низкого (тогда улучшим) и хорошего качества 🎨&#10;&#10;— Уберём недостатки&#10;— Раскрасим&#10;— Повысим качество&#10;— Подберём хороший формат&#10;&#10;Делаем через нейросети 🤖"
                  data-gallery='["assets/video/services/srv-animation-demo.mp4"]'>
                  <h3 class="srv-name">ОЖИВЛЕНИЕ ФОТО</h3>
                  <img class="srv-img" src="assets/img/services/srv-animation.webp" alt="Оживление фото — пример">
                  <a class="btn more-btn" href="animation.html">ПОДРОБНЕЕ</a>
                </article>
              </div>

              <div class="swiper-slide">
                <article class="service-card"
                  data-title="Мультик про вас"
                  data-price="от 1000 ₽ за 1 минуту"
                  data-deadline="Сроки: 3–5 дней"
                  data-desc="Создадим короткий мультфильм по вашей истории 📺&#10;&#10;— Персонажи сильно похожи на вас&#10;— Могут говорить вашими голосами&#10;— Сами выбираете стиль мультика&#10;— Сценарий — ваша история!&#10;&#10;Делаем через нейросети 🤖"
                  data-gallery='["assets/video/services/srv-story-demo.mp4"]'>
                  <h3 class="srv-name">МУЛЬТИК ПРО ВАС</h3>
                  <img class="srv-img" src="assets/img/services/srv-cartoon-main.webp" alt="Мультик про вас — постер">
                  <a class="btn more-btn" href="story.html">ПОДРОБНЕЕ</a>
                </article>
              </div>

              <div class="swiper-slide">
                <article class="service-card"
                  data-title="Фото в стиле мультика"
                  data-price="от 300 ₽ за 1 фото"
                  data-deadline="Сроки: 1 день"
                  data-desc="Стилизуем ваши фото под любимый мультфильм, аниме, комикс, живопись —возможно практически всё!"
                  data-gallery='["assets/img/services/srv-cartoon-photo.webp"]'>
                  <h3 class="srv-name">ФОТО В СТИЛЕ МУЛЬТИКА</h3>
                  <img class="srv-img" src="assets/img/services/srv-cartoon-photo.webp" alt="Фото в стиле мультика — пример">
                  <a class="btn more-btn" href="toonphoto.html">ПОДРОБНЕЕ</a>
                </article>
              </div>

              <div class="swiper-slide">
                <article class="service-card"
                  data-title="Оригинальное арт-фото"
                  data-price="от 5000 ₽ за 1 фото"
                  data-deadline="Сроки: 1–2 дня"
                  data-desc="Сделаем уникальный персональный арт-подарок под ваш запрос:&#10;&#10;— Сохраним внешность&#10;— Поместим в желаемую сцену&#10;— Если нужно, переоденем и причешем&#10;— Добавим нужные атрибуты и фон&#10;— Пришлём формат для печати&#10;&#10;Делаем руками в Photoshop и дожимаем через нейросети 🤖"
                  data-gallery='["assets/img/services/srv-original.webp"]'>
                  <h3 class="srv-name">ОРИГИНАЛЬНОЕ АРТ-ФОТО</h3>
                  <img class="srv-img" src="assets/img/services/srv-original.webp" alt="Оригинальное арт-фото — пример">
                  <button class="btn more-btn" type="button" onclick="event.stopImmediatePropagation(); window.location.href='original.html';">ПОДРОБНЕЕ</button>
                </article>
              </div>

              <div class="swiper-slide">
                <article class="service-card"
                  data-title="Повторим тренды"
                  data-price="500 ₽ за 1 фото"
                  data-deadline="Сроки: 1 день"
                  data-desc="Просто пришлите нам ссылку на тренд, и мы повторим его с вашим фото!"
                  data-gallery='["assets/img/services/srv-trend-main.webp"]'>
                  <h3 class="srv-name">ПОВТОРИМ ТРЕНДЫ</h3>
                  <img class="srv-img" src="assets/img/services/srv-trend-main.webp" alt="Повтор тренда — пример">
                  <button class="btn more-btn" type="button" onclick="event.stopImmediatePropagation(); window.location.href='trends.html';">ПОДРОБНЕЕ</button>
                </article>
              </div>
            </div>
          </div>

          <button class="srv-arrow srv-next" aria-label="Следующая услуга"></button>
        </div>
      </div>
    </section>

    <!-- REVIEWS (Новая карусель) -->
    <section id="reviews" class="section">
      <div class="container">
        <h2 class="section-title">ОТЗЫВЫ</h2>

        <div class="reviews-wrap" id="revWrap">
          <div class="rev-carousel" id="revCarousel" aria-roledescription="carousel">
            <button class="rev-arrow rev-prev" aria-label="Предыдущий отзыв"></button>
            <div class="rev-viewport" id="revViewport">
              <div class="rev-pane" id="revPane"></div>
            </div>
            <button class="rev-arrow rev-next" aria-label="Следующий отзыв"></button>
          </div>
          <div class="rev-dots" id="revDots" aria-hidden="false"></div>

          <!-- Шаблоны отзывов (не отображаются) -->
          <template data-review>
            <article class="review-card">
              <div class="rev-body">
                <div class="rev-head">
                  <span class="rev-avatar"><img src="assets/img/reviews/avatars/ava-yulya-01.webp" alt="Юлия — аватар"></span>
                  <div class="rev-title">Юлия: делали ей <a href="toonphoto.html" target="_blank" rel="noopener"><strong>стилизацию фото</strong></a> под<br>шарж на день рождения другу</div>
                </div>
                <div class="rev-text">Результатом остались довольны все! И заказчик и именник !!! Заказ был сложный, тк нужно было обработать 4 персонажа. Андреем было предложено несколько вариантов на выбор, также были услышаны и проработаны до мелочей все наши правки и пожелания. Спасибо. Обязательно ещё обратимся! Это индивидуальны и необычный подарок 🎁!</div>
              </div>
              <a class="rev-media review-open" href="assets/img/reviews/media/toonphoto/rev-toonphoto-01.webp" data-type="image">
                <img src="assets/img/reviews/media/toonphoto/rev-toonphoto-01.webp" alt="Результат — стилизация под шарж">
              </a>
            </article>
          </template>

          <template data-review>
            <article class="review-card">
              <div class="rev-body">
                <div class="rev-head">
                  <span class="rev-avatar"><img src="assets/img/reviews/avatars/ava-katya-02.webp" alt="Катя — аватар"></span>
                  <div class="rev-title">Катя, делали <a href="story.html" target="_blank" rel="noopener"><strong>мультик на свадьбу</strong></a> по истории молодожёнов</div>
                </div>
                <div class="rev-text">Такая вот мульистория о нас от NeuroSoul AI! Душевно получилось ❤️ прекрасная идея для подарка</div>
              </div>
              <a class="rev-media review-open" href="assets/video/reviews/story/rev-story-01.mp4" data-type="video">
                <video src="assets/video/reviews/story/rev-story-01.mp4" controls preload="metadata" playsinline></video>
              </a>
            </article>
          </template>

          <template data-review>
            <article class="review-card">
              <div class="rev-body">
                <div class="rev-head">
                  <span class="rev-avatar"><img src="assets/img/reviews/avatars/ava-dasha-03.webp" alt="Даша — аватар"></span>
                  <div class="rev-title">Даша, делали ей <a href="toonphoto.html" target="_blank" rel="noopener"><strong>стилизацию фото</strong></a> под мультфильмы Хаяо Миядзаки</div>
                </div>
                <div class="rev-text">Обращалась к ребятам, с запросом "хочу как будто Хаяо Миядзаки нарисовал". Получилось — очень красота. Рекомендую 👌</div>
              </div>
              <a class="rev-media review-open" href="assets/img/reviews/media/toonphoto/rev-toonphoto-02.webp" data-type="image">
                <img src="assets/img/reviews/media/toonphoto/rev-toonphoto-02.webp" alt="Результат — в стиле Хаяо Миядзаки">
              </a>
            </article>
          </template>
        </div>
      </div>
    </section>

    <!-- CONTACTS -->
    <section id="contacts" class="section section--stub">
      <div class="container">
        <h2 class="section-title">СВЯЗАТЬСЯ С НАМИ</h2>

        <div class="contact-card">
          <form class="contact-form" id="contactForm">
            <div>
              <label for="cf-name">Имя *</label>
              <input id="cf-name" type="text" name="name" required placeholder="Как к вам обращаться?">
            </div>
            <div>
              <label for="cf-contact">Почта / Telegram *</label>
              <input id="cf-contact" type="text" name="contact" required placeholder="email или @username">
            </div>
            <div>
              <label for="cf-msg">Комментарий *</label>
              <textarea id="cf-msg" name="message" required placeholder="Кратко опишите задачу"></textarea>
            </div>
            <div>
              <label for="cf-file">Прикрепление файла *</label>
              <input id="cf-file" type="file" name="attachment" required>
              <div class="muted-sm">Поддерживаются изображения, видео и архивы.</div>
            </div>
            <div class="contact-actions">
              <button class="btn btn-primary" type="submit">Отправить заявку</button>
              <a class="btn btn-tg" href="https://t.me/neurosoulai?direct" target="_blank" rel="noopener">Мы в Telegram</a>
            </div>
          </form>
        </div>
      </div>
    </section>
  </main>

  <!-- Lightbox для отзывов -->
  <div id="revLightbox" class="revlightbox" aria-hidden="true">
    <div class="revlightbox__box" role="dialog" aria-modal="true" aria-label="Просмотр медиа отзыва">
      <button class="revlightbox__close" aria-label="Закрыть">×</button>
      <div id="revLbMedia" class="revlightbox__media"></div>
    </div>
  </div>

  <!-- THANK-YOU POPUP (добавлено) -->
  <div id="thanksModal" aria-hidden="true">
    <div class="thanks-backdrop" data-close="true"></div>
    <div class="thanks-dialog" role="dialog" aria-modal="true" aria-labelledby="thanksTitle" aria-describedby="thanksDesc">
      <button class="thanks-close" aria-label="Закрыть" data-close="true">×</button>
      <h3 id="thanksTitle" class="thanks-title">Спасибо за обращение!</h3>
      <p id="thanksDesc" class="thanks-text">Свяжемся с вами в ближайшее время 💛</p>
      <div class="thanks-actions">
        <button id="thanksContinue" class="thanks-btn" type="button">Продолжить</button>
      </div>
    </div>
  </div>

  <!-- MODAL услуг (без изменений) -->
  <div class="modal" id="serviceModal" aria-hidden="true" role="dialog" aria-labelledby="modalTitle">
    <div class="modal__backdrop"></div>
    <div class="modal__dialog" role="document">
      <button class="modal__close" aria-label="Закрыть">×</button>
      <div class="modal__grid">
        <div class="modal__media">
          <div class="swiper gallery-swiper">
            <div class="swiper-wrapper" id="modalGallery"></div>
            <div class="swiper-pagination"></div>
            <button class="gal-arrow gal-prev" aria-label="Назад"></button>
            <button class="gal-arrow gal-next" aria-label="Вперёд"></button>
          </div>
        </div>
        <div class="modal__info">
          <h3 id="modalTitle" class="modal__title">Название услуги</h3>
          <div id="modalPrice" class="modal__price">—</div>
          <div id="modalDeadline" class="modal__deadline">—</div>
          <p id="modalDesc" class="modal__desc" style="white-space: pre-line;">Описание услуги.</p>
          <div class="modal__cta">
            <a class="btn modal-cta cta-site" href="#contacts">Заказать на сайте</a>
            <a class="btn btn-tg modal-cta cta-tg" href="https://t.me/neurosoulai?direct" target="_blank" rel="noopener">Заказать в Telegram</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Swiper для услуг -->
  <script src="https://unpkg.com/swiper@11/swiper-bundle.min.js"></script>

  <script>
    /* ===== SERVICES SWIPER (как было) ===== */
    const wrap = document.getElementById('srvWrap');
    const servicesSwiper = new Swiper('.services-swiper', {
      loop:true, speed:550, grabCursor:true, centeredSlides:true,
      slidesPerView:1.12, spaceBetween:18, keyboard:{enabled:true},
      navigation:{ nextEl:'.srv-next', prevEl:'.srv-prev' },
      breakpoints:{
        768:{ slidesPerView:1.10, spaceBetween:16 },
        1024:{ slidesPerView:1.48, spaceBetween:0 },
        1280:{ slidesPerView:1.86, spaceBetween:0 },
        1440:{ slidesPerView:1.95, spaceBetween:0 }
      },
      on:{
        slideChangeTransitionStart(){ wrap.classList.add('is-animating'); },
        slideChangeTransitionEnd(){ wrap.classList.remove('is-animating'); }
      }
    });

    /* ===== Лёгкая карусель отзывов (loop, drag, dots) ===== */
    const revWrap    = document.getElementById('revWrap');
    const revViewport= document.getElementById('revViewport');
    const revPane    = document.getElementById('revPane');
    const revPrev    = document.querySelector('.rev-prev');
    const revNext    = document.querySelector('.rev-next');
    const revDots    = document.getElementById('revDots');

    const reviewTpls = Array.from(document.querySelectorAll('#reviews template[data-review]'));
    const reviews    = reviewTpls.map(t => t.innerHTML.trim());
    let rIdx = 0;

    // точки
    reviews.forEach((_, i) => {
      const b = document.createElement('button');
      b.type = 'button'; b.className = 'rev-dot' + (i===0?' is-active':'');
      b.addEventListener('click', () => showReview(i));
      b.setAttribute('aria-label', `Показать отзыв ${i+1}`);
      revDots.appendChild(b);
    });

    function updateDots(){
      [...revDots.children].forEach((d, n) => d.classList.toggle('is-active', n === rIdx));
    }

    function showReview(i){
      rIdx = (i + reviews.length) % reviews.length; // бесконечный цикл
      revPane.style.transition = 'none';
      revPane.style.transform = 'translateX(0)';
      revPane.innerHTML = reviews[rIdx];
      updateDots();
    }

    // Стартовый рендер
    showReview(0);

    // Навигация
    revPrev.addEventListener('click', () => showReview(rIdx-1));
    revNext.addEventListener('click', () => showReview(rIdx+1));
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft')  showReview(rIdx-1);
      if (e.key === 'ArrowRight') showReview(rIdx+1);
    });

    // Drag/Swipe как на страницах услуг
    let pointerId = null, startX = 0, startY = 0, deltaX = 0;
    function onDown(e){
      pointerId = e.pointerId ?? 'mouse';
      startX = e.clientX; startY = e.clientY; deltaX = 0;
      document.getElementById('revCarousel').classList.add('is-dragging');
      revPane.style.transition = 'none';
      if (e.pointerId != null) revViewport.setPointerCapture(e.pointerId);
    }
    function onMove(e){
      if (pointerId === null) return;
      if (e.pointerId != null && e.pointerId !== pointerId) return;
      deltaX = e.clientX - startX;
      const dY = Math.abs(e.clientY - startY);
      if (Math.abs(deltaX) > dY) revPane.style.transform = `translateX(${deltaX * 0.25}px)`;
    }
    function onUp(e){
      if (pointerId === null || (e.pointerId != null && e.pointerId !== pointerId)) return;
      if (e.pointerId != null) revViewport.releasePointerCapture(e.pointerId);
      document.getElementById('revCarousel').classList.remove('is-dragging');
      revPane.style.transition = 'transform .18s ease';
      revPane.style.transform = 'translateX(0)';

      const dY = Math.abs(e.clientY - startY);
      if (Math.abs(deltaX) > 50 && Math.abs(deltaX) > dY) {
        showReview(deltaX > 0 ? rIdx-1 : rIdx+1);
      }
      pointerId = null;
    }
    revViewport.addEventListener('pointerdown', onDown);
    revViewport.addEventListener('pointermove', onMove);
    revViewport.addEventListener('pointerup', onUp);
    revViewport.addEventListener('pointercancel', onUp);
    revViewport.addEventListener('wheel', (e) => {
      if (Math.abs(e.deltaX) > Math.abs(e.deltaY) && Math.abs(e.deltaX) > 20) {
        e.preventDefault();
        showReview(e.deltaX > 0 ? rIdx+1 : rIdx-1);
      }
    }, { passive:false });

    /* ===== Лайтбокс для отзывов (без прыжка вверх) ===== */
    const rb = document.getElementById('revLightbox');
    const rbMedia = document.getElementById('revLbMedia');
    const rbClose = rb.querySelector('.revlightbox__close');
    let savedRevScroll = 0;

    function lockBodyScroll(){
      // сохраняем позицию и фиксируем body
      savedRevScroll = window.scrollY || document.documentElement.scrollTop;
      document.body.style.top = `-${savedRevScroll}px`;
      document.body.classList.add('body-lock');
    }
    function unlockBodyScroll(){
      document.body.classList.remove('body-lock');
      document.body.style.top = '';
      window.scrollTo(0, savedRevScroll);
    }

    function openRB(href, type){
      rbMedia.innerHTML = (type==='video' || /\.(mp4|webm|ogg)(\?.*)?$/i.test(href))
        ? `<video src="${href}" controls autoplay playsinline></video>`
        : `<img src="${href}" alt="">`;
      rb.setAttribute('aria-hidden','false');
      lockBodyScroll();
      // фокус на кнопку закрытия для доступности
      setTimeout(()=>rbClose.focus?.(), 0);
    }
    function closeRB(){
      rb.setAttribute('aria-hidden','true');
      rbMedia.innerHTML = '';
      unlockBodyScroll();
    }

    // Делегирование: клики по медиа внутри текущей карточки
    revPane.addEventListener('click', (e) => {
      const a = e.target.closest('.review-open');
      if (!a) return;
      e.preventDefault(); // блокируем переход по ссылке (чтобы не прыгало)
      openRB(a.getAttribute('href'), a.dataset.type || 'image');
    });
    rb.addEventListener('click', e=>{ if(e.target===rb) closeRB(); });
    rbClose.addEventListener('click', closeRB);
    document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeRB(); });

    /* ===== THANK-YOU POPUP логика (добавлено) ===== */
    const thanksModal = document.getElementById('thanksModal');
    const thanksBtn = document.getElementById('thanksContinue');

    function openThanks(){
      thanksModal.setAttribute('aria-hidden','false');
      setTimeout(()=>thanksBtn?.focus?.(), 0);
    }
    function closeThanks(){
      thanksModal.setAttribute('aria-hidden','true');
    }
    // Закрытие по фону/крестику/Esc
    thanksModal.addEventListener('click', (e)=>{
      if (e.target?.dataset?.close === 'true') closeThanks();
    });
    document.addEventListener('keydown', (e)=>{
      if (thanksModal.getAttribute('aria-hidden') === 'false' && e.key === 'Escape') closeThanks();
    });
    // Кнопка "Продолжить": возвращаем к разделу контактов
    thanksBtn?.addEventListener('click', ()=>{
      closeThanks();
      if (location.hash !== '#contacts') location.hash = '#contacts';
      document.getElementById('contacts')?.scrollIntoView({behavior:'smooth', block:'start'});
    });

    // Открываем попап сразу по клику на кнопку отправки (не меняя обработчик формы)
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('#contactForm button[type="submit"]');
      if (!btn) return;
      // Показать окно благодарности сразу после нажатия
      openThanks();
    });
  </script>

  <!-- ===== ОБРАБОТЧИК ОТПРАВКИ ФОРМЫ (Apps Script) ===== -->
  <script>
    // URL развернутого веб-приложения Apps Script
    const GAS_ENDPOINT = "https://script.google.com/macros/s/AKfycbyN6BYY6jv6a7U79uBIlajhBGZkrXiRUhPyMCbAv7--obOzEXPbVWrvJ6VgPN89rhU/exec";

    const contactForm = document.getElementById('contactForm');
    if (contactForm) {
      contactForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const submitBtn = contactForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Отправляем…';

        const fd = new FormData(contactForm);
        fd.append('referer', location.href);

        try {
          // Пытаемся обычный запрос (с чтением ответа)
          const res = await fetch(GAS_ENDPOINT, { method: 'POST', body: fd, credentials: 'omit' });

          if (!res.ok) throw new Error('HTTP ' + res.status);

          // Если ответ JSON — отлично, но нам достаточно факта успешной отправки
          try { await res.json(); } catch(_) {}
          alert('Заявка отправлена! Мы свяжемся с вами.');
          contactForm.reset();
        } catch (err) {
          // Если упёрлись в CORS/префлайт, делаем «спящий» no-cors (письмо всё равно уйдёт)
          try {
            await fetch(GAS_ENDPOINT, { method: 'POST', body: fd, mode: 'no-cors', credentials: 'omit' });
            alert('Заявка отправлена! Мы свяжемся с вами.');
            contactForm.reset();
          } catch (e2) {
            console.error('Send failed:', err, e2);
            alert('Не удалось отправить заявку. Попробуйте позже или напишите нам в Telegram.');
          }
        } finally {
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });
    }
  </script>
</body>
</html>
